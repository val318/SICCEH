<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>SICCE – ENCB</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{
  --primary:#6c0538; 
  --primary-dark:#83034382; 
  --bg:#f4f4f4; 
  --card:#fff; 
  --text:#222; 
  --success:#28a745; 
  --warning:#ffc107;
}
[data-theme="dark"]{
  --bg:#0f1112; 
  --card:#121212; 
  --text:#eee;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:'Poppins',sans-serif;}
body{background:var(--bg);color:var(--text);}
header{
  background:linear-gradient(90deg, #6c0538, #b8135c);
  color:#fff;padding:20px;text-align:center;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
}
header h1{font-size:22px;margin-bottom:6px;}
header p{font-size:14px;color:#f0eaea;}

main{max-width:1100px;margin:20px auto;padding:18px;display:none;display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:20px;}

.card{
  background:var(--card);
  padding:20px;
  border-radius:12px;
  box-shadow:0 4px 20px rgba(0,0,0,0.08);
  transition:0.3s;
}
.card:hover{transform:translateY(-3px);}

input,select,button,textarea{font-family:inherit;font-size:15px}
input,select,textarea{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid #ccc;background:transparent;color:var(--text)}
button{
  background:linear-gradient(90deg,#6c0538,#b8135c);
  color:#fff;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;
  transition:0.2s;
}
button:hover{transform:scale(1.05);}

nav{
  position:sticky;top:0;
  display:flex;
  justify-content:flex-start;
  align-items:center;
  background:var(--card);
  padding:12px;
  border-radius:12px;
  margin:0 auto 20px;
  max-width:1100px;
  gap:12px;
  z-index:100;
}
nav a{color:var(--primary);text-decoration:none;font-weight:600;}
nav a:hover{text-decoration:underline;}

.small{font-size:13px;color:gray;margin-top:6px;}
.table-wrap{overflow:auto;max-height:380px;margin-top:12px;}
.table{width:100%;border-collapse:collapse;}
.table th,.table td{padding:8px;border-bottom:1px solid rgba(0,0,0,.08);font-size:14px;text-align:left;}

.profile-modal{
  position:fixed;inset:0;
  display:none;align-items:center;justify-content:center;
  background:rgba(0,0,0,.45);
  padding:20px;
  backdrop-filter:blur(5px);
}
.profile-modal .card{width:360px;max-width:95%;}

.pulse{animation:pop .6s ease}
@keyframes pop{0%{transform:scale(.9)}60%{transform:scale(1.05)}100%{transform:scale(1)}}

/* Barra progreso colillas */
.progress-bar{
  width:100%;background:#eee;border-radius:10px;margin-top:10px;
}
.progress-fill{
  height:16px;border-radius:10px;background:var(--success);width:0%;transition:0.5s;
  text-align:center;color:#fff;font-size:12px;line-height:16px;
}
</style>
</head>
<body>
<header>
  <h1>SICCE — Sistema Integral de Captura de Colillas</h1>
  <p class="small">ENCB · Proyecto de recolección y biodegradación</p>
</header>

<!-- LOGIN -->
<section id="loginScreen" class="card" style="max-width:420px;margin:28px auto">
  <h2>Iniciar sesión</h2>
  <input id="loginEmail" type="email" placeholder="Correo institucional">
  <input id="loginPass" type="password" placeholder="Contraseña">
  <div style="display:flex;gap:8px;margin-top:10px">
    <button id="btnLogin" style="flex:1">Entrar</button>
    <button id="btnShowRegister" style="flex:1">Crear cuenta</button>
  </div>
  <p id="loginMsg" class="small"></p>
</section>

<!-- REGISTRO -->
<section id="registroScreen" class="card" style="display:none;max-width:420px;margin:28px auto">
  <h2>Crear cuenta</h2>
  <input id="regEmail" type="email" placeholder="Correo institucional">
  <input id="regPass" type="password" placeholder="Contraseña">
  <div style="display:flex;gap:8px;margin-top:10px">
    <button id="btnRegister" style="flex:1">Registrarse</button>
    <button id="btnCancelRegister" style="flex:1">Cancelar</button>
  </div>
  <p id="regMsg" class="small"></p>
</section>

<!-- NAV -->
<nav id="menu" style="display:none">
  <a href="#intro">¿Quienes somos?</a>
  <a href="#registro">Registrar</a>
  <a href="#impacto">Impacto</a>
  <a href="#historial">Historial</a>
  <a href="#adminPanel" id="adminBtn" style="display:none">Administración</a>
  <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
    <button id="btnTheme">Modo oscuro</button>
    <button id="btnProfile">Perfil</button>
    <button id="btnLogout">Salir</button>
  </div>
</nav>

<!-- MAIN -->
<main id="contenido" style="display:none">

  <section id="intro" class="card">
    <h2>Introducción</h2>
    <p>La contaminación por colillas de cigarro es un problema ambiental global. Cada año se desechan más de 4.5 billones de colillas en el mundo, cuyos filtros de acetato de celulosa liberan microplásticos, nicotina y metales pesados que contaminan el agua, el suelo y afectan a diversas especies.
Diversos estudios han demostrado que los hongos Pleurotus ostreatus pueden degradar el acetato de celulosa mediante enzimas ligninolíticas y celulasas, reduciendo la toxicidad del residuo.
En SICCE proponemos implementar un sistema de recolección y biodegradación de colillas en la ENCB como modelo inicial.</p>
  </section>

  <section id="registro" class="card">
    <h2>Registrar colillas</h2>
    <p id="userLabel" class="small"></p>
    <input id="colillasInput" type="number" placeholder="Cantidad de colillas">
    <div style="display:flex;gap:8px;margin-top:10px">
      <button id="btnSaveColillas">Guardar</button>
    </div>
    <p id="saveMsg" class="small"></p>
    <h3>Total acumulado: <span id="totalUser">0</span></h3>
    <div class="progress-bar"><div class="progress-fill" id="progressColillas">0%</div></div>
    <div id="chartContainer" style="max-width:700px;margin-top:12px"><canvas id="chartCanvas"></canvas></div>
  </section>

  <section id="impacto" class="card">
    <h2>Impacto</h2>
    <p>Nivel: <span id="badgeLevel">0</span> — Rango: <span id="badgeRank">Principiante</span></p>
  </section>

  <section id="historial" class="card">
    <h2>Historial de depósitos</h2>
    <label>Eliminar por fecha (usuario):</label>
    <input type="date" id="delDate" style="margin-top:8px">
    <button id="btnDeleteByDate" style="margin-top:8px">Eliminar por fecha</button>
    <ul id="historialLista" class="small" style="margin-top:14px"></ul>
  </section>

  <section id="adminPanel" class="card" style="display:none">
    <h2>Panel de Administración</h2>

    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <label style="min-width:140px">Seleccionar usuario:</label>
      <select id="adminUserSelect" style="flex:1"></select>
    </div>
    <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
      <input type="date" id="adminDelDate">
      <button id="btnAdminDeleteByDate">Borrar historial por fecha</button>
      <button id="btnAdminDeleteAll">Borrar todo historial</button>
    </div>

    <hr style="margin:12px 0">

    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <button id="btnRefreshAdmin">Actualizar</button>
      <button id="btnExportCSV">Exportar CSV</button>
      <button id="btnResetAll">Reiniciar todo</button>
    </div>

    <div id="adminList" class="table-wrap" style="margin-top:12px"></div>
  </section>
</main>

<!-- Profile modal -->
<div class="profile-modal" id="profileModal">
  <div class="card">
    <h3>Perfil</h3>
    <p id="pEmail"></p>
    <p id="pColillas"></p>
    <p id="pNivel"></p>
    <div style="display:flex;justify-content:flex-end;margin-top:12px">
      <button id="btnCloseProfile">Cerrar</button>
    </div>
  </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="sicce.js"></script> <!-- tu JS actual sin QR -->

</body>
</html>
